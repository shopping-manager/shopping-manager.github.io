(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"63ae":function(e,t,a){"use strict";var n=a("b1e0"),i=a.n(n);i.a},7166:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gmap-wrapper"},[a("GmapMap",{ref:"map",staticClass:"gmap",attrs:{center:e.center,zoom:16,options:e.mapOptions}},e._l(e.markers,(function(t,n){return a("gmap-custom-marker",{key:n,staticClass:"gmap-marker-wrapper",attrs:{marker:t.position,alignment:"center"},nativeOn:{click:function(a){return e.toggleInfoWindow(t,n)}}},[a("div",{class:"gmap-marker busy-"+t.busy_ind+" "},[a("q-icon",{staticClass:"gmap-marker-icon",attrs:{name:e.iconMap[t.type]}})],1)])})),1),a("q-page-sticky",{attrs:{position:"bottom-left",offset:[18,18]}},[a("q-btn",{attrs:{fab:"",icon:"o_refresh",color:"accent",loading:e.loading},on:{click:e.fetchData}})],1),a("q-page-sticky",{attrs:{position:"bottom-left",offset:[80,18]}},[a("q-btn",{attrs:{fab:"",icon:"o_list",color:"accent",to:"/shoppinglist"}})],1),a("q-dialog",{model:{value:e.placeDialogOpen,callback:function(t){e.placeDialogOpen=t},expression:"placeDialogOpen"}},[a("q-card",{class:"store-card busy-"+e.placeDialogData.busy_ind},[a("q-card-section",[a("div",{staticClass:"row no-wrap items-center"},[a("div",{staticClass:"col text-h6 ellipsis",staticStyle:{"text-align":"center"}},[e._v("\n            "+e._s(e.placeDialogData.name)+"\n          ")])])]),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticStyle:{"text-align":"center"}},[a("q-rating",{staticStyle:{"text-align":"center"},attrs:{max:5,color:"white","color-selected":"white",size:"32px",icon:"o_directions_walk",readonly:""},model:{value:e.placeDialogData.busy_ind,callback:function(t){e.$set(e.placeDialogData,"busy_ind",t)},expression:"placeDialogData.busy_ind"}})],1),a("div",{staticClass:"text-subtitle1 store-card-busystatus q-mt-xs"},[e._v("\n          "+e._s(e.busyTexts[e.placeDialogData.busy_ind])+"\n        ")])]),e.placeDialogData.present_supply.length>0?a("q-card-section",{staticClass:"q-pt-none"},[a("p",{staticClass:"q-mb-none q-mt-xs",staticStyle:{"text-align":"center"}},[e._v("Available supply: ")]),a("div",{staticStyle:{"text-align":"center"}},e._l(e.placeDialogData.present_supply,(function(t,n){return a("q-chip",{key:n,staticClass:"available-item-chip",attrs:{"text-color":"white",icon:"o_local_pizza"}},[e._v(e._s(t.name))])})),1)]):e._e(),e.placeDialogData.missing_supply.length>0?a("q-card-section",{staticClass:"q-pt-none missing-items-section"},[a("p",{staticClass:"q-mb-none q-mt-xs",staticStyle:{"text-align":"center"}},[e._v("The following was reported missing: ")]),a("div",{staticStyle:{"text-align":"center"}},e._l(e.placeDialogData.missing_supply,(function(t,n){return a("q-chip",{key:n,attrs:{outline:"",color:"white",icon:"o_local_pizza"}},[a("span",{staticClass:"item-missing"},[e._v(e._s(t.name))])])})),1)]):e._e(),a("q-separator"),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"white",label:"Report shortage",to:"/reportshortage"}}),a("q-btn",{attrs:{flat:"",round:"",color:"white",icon:"o_feedback",to:"/reportstoreproblem"}})],1)],1)],1)],1)},i=[],s=a("967e"),o=a.n(s),l=(a("7f7f"),a("4db1")),r=a.n(l),c=(a("96cf"),a("fa84")),p=a.n(c),u=a("6cee"),m={name:"MainMap",components:{GmapCustomMarker:u["a"]},data:function(){return{dbgRandomBusy:!0,fallbackCenter:{lat:47.3824551,lng:8.5244547},center:{lat:47.3824551,lng:8.5244547},reportedCenter:{lat:47.3824551,lng:8.5244547},loading:!1,iconMap:{supermarket:"o_shopping_cart",convenience:"o_storefront",pharmacy:"o_local_pharmacy"},busyTexts:{1:"Clear",2:"A bit busy",3:"Busy",4:"Possible waiting line outside",5:"Crowded - expect to wait"},markers:[{position:{lat:46.2033337,lng:7.3491754},busy:15,busy_ind:1,type:"supermarket"},{position:{lat:46.2033337,lng:7.3001754},busy:35,busy_ind:2,type:"pharmacy"},{position:{lat:46.2333337,lng:7.2801754},busy:55,busy_ind:3,type:"convenience"},{position:{lat:46.2433337,lng:7.3101754},busy:75,busy_ind:4,type:"supermarket"},{position:{lat:46.2433337,lng:7.3601754},busy:95,busy_ind:5,type:"supermarket"}],currentMarker:null,placeDialogOpen:!1,placeDialogData:{attendance:0,name:"",missing_supply:[],present_supply:[]},essentialItemRef:[{name:"Toilet paper"},{name:"Bread"},{name:"Produce"},{name:"Fruit"},{name:"Pasta"},{name:"Milk"}],places:[],currentPlace:null,mapOptions:{zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,disableDefaultUi:!1,styles:[{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#e0efef"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{hue:"#1900ff"},{color:"#c0e8e8"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#7dcdcd"}]}]},infoContent:"",infoWindowPos:null,infoWinOpen:!1,currentMidx:null,currentMarkerOpen:-1,infoOptions:{pixelOffset:{width:0,height:-35}}}},mounted:function(){this.geolocate(),this.fetchData()},methods:{fetchData:function(){var e=p()(o.a.mark((function e(){var t,a,n,i=this;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object({NODE_ENV:"production",CLIENT:!0,SERVER:!1,DEV:!1,PROD:!0,MODE:"spa",VUE_ROUTER_MODE:"hash",VUE_ROUTER_BASE:"",APP_URL:"undefined"}).API_SERVER+"/stores",this.loading=!0,e.prev=2,e.next=5,this.$axios.get(t);case 5:a=e.sent,this.loading=!1,n=a.data,this.markers.length=0,n.map((function(e,t,a){var n=r()(i.essentialItemRef),s=[{name:"Toilet paper"},{name:"Pasta"},{name:"Rice"},{name:"Cheese"},{name:"Tomato sauce"}];s=s.filter((function(e){return Math.random()>.8})),s.map((function(e){console.log(n),n=n.filter((function(t){return t.name!=e.name}))})),i.markers.push({position:{lat:e.lat,lng:e.long},busy:e.busy,busy_ind:i.dbgRandomBusy?Math.floor(5*Math.random())+1:Math.floor(e.busy/20)+1,type:e.type,name:e.name,g_url:e.url,missing_supply:s,present_supply:n})})),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](2),this.loading=!1,console.error(e.t0);case 16:case"end":return e.stop()}}),e,this,[[2,12]])})));function t(){return e.apply(this,arguments)}return t}(),toggleInfoWindow:function(e,t){this.currentMarker=e,this.placeDialogData=e,this.placeDialogOpen=!0},updateCenter:function(e){this.reportedCenter={lat:e.lat(),lng:e.lng()}},syncCenter:function(){this.center=this.reportedCenter},geolocate:function(){var e=this;console.log("Geolocate"),navigator.geolocation.getCurrentPosition((function(t){e.reportedCenter={lat:t.coords.latitude,lng:t.coords.longitude},e.center=e.reportedCenter,console.log(e.center)}),(function(t){2==t.code&&(console.log("Error 2"),e.center=e.fallbackCenter,e.reportedCenter=e.fallbackCenter)}))},markerClick:function(e){console.log("Marker clicked"),console.log(e)}}},g=m,y=(a("63ae"),a("2877")),d=a("eebe"),f=a.n(d),b=a("0016"),h=a("de5e"),_=a("9c40"),C=a("24e8"),v=a("f09f"),k=a("068f"),D=a("a370"),w=a("daf4"),x=a("b047"),q=a("eb85"),T=a("4b7e"),O=a("7f67"),M=Object(y["a"])(g,n,i,!1,null,null,null);t["default"]=M.exports;f()(M,"components",{QIcon:b["a"],QPageSticky:h["a"],QBtn:_["a"],QDialog:C["a"],QCard:v["a"],QImg:k["a"],QCardSection:D["a"],QRating:w["a"],QChip:x["a"],QSeparator:q["a"],QCardActions:T["a"]}),f()(M,"directives",{ClosePopup:O["a"]})},b1e0:function(e,t,a){}}]);